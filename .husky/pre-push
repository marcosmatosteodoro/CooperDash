#!/bin/sh

echo "ğŸš€ Running pre-push checks with Docker..."

echo "ğŸ” Running PHP lint checks..."
docker-compose run -T --rm backend composer validate --no-check-all --strict
# docker-compose run --rm backend vendor/bin/pint --test

echo "ğŸ” Running Node.js lint checks..."
docker-compose run -T --rm frontend npm run lint

echo "ğŸ§ª Running PHP tests..."
docker-compose run -T --rm backend php artisan test --env=testing

echo "ğŸ§ª Running Node.js tests..."
docker-compose run -T --rm frontend npm test -- --ci --passWithNoTests

echo "ğŸ—ï¸ Building production frontend..."
docker-compose run -T --rm frontend npm run build

echo "âœ… All checks passed! Ready to push."

# Stop containers
docker-compose down